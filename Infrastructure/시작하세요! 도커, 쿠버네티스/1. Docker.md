# Docker

- Docker는 linux container에 여러 기능을 추가함으로써 애플리케이션을 컨테이너로서 좀 더 쉽게 사용할 수 있게 만들어진  
  오픈소스 프로젝트이다.

## VM과 Docker container

- 기존의 가상화 기술은 hypervisor를 이용해 여러 개의 OS를 하나의 host에서 생성해 사용하는 방식이었다.  
  이러한 여러 개의 OS들은 VM이라는 단위로 구별되고, 각 VM에는 Ubuntu, CentOS 등의 OS가 설치되어 사용된다.  
  Hypervisor에 의해 생성되고 관리되는 OS는 Guest OS라고 하며, 각 guest OS는 다른 guest OS와는 완전히 독립된 공간과  
  시스템 자원을 할당받아 사용한다. 이러한 가상화 방식을 사용할 수 있는 대표적인 가상화 도구로 VMWare, VirtualBox 등이 있다.

  ![picture 117](/images/DK_1_1.png)

- 그러나 각종 시스템 자원을 가상화하고 독립된 공간을 생성하는 작업은 hypervisor를 반드시 거쳐야하기 때문에 일반 host에 비해 성능의  
  손실이 발생한다. 뿐만 아니라 VM은 guest OS를 사용하기 위한 라이브러리, 커널 등을 전부 포함하기 때문에 VM을 배포하기 위한 이미지로  
  만들었을 때 이미지의 크기도 커진다. 즉 VM은 완벽한 OS를 생성할 수 있다는 장점은 있지만 일반 host에 비해 성능 손실이 있을 수 있으며  
  수 GB에 달하는 VM image를 애플리케이션으로 배포하기에는 부담스럽다는 단점이 있다.

- 이에 비해 dockeer container는 가상화된 공간을 생성하기 위해 linux의 자체 기능인 chroot, namespace, cgroup을 사용함으로써  
  프로세스 단위의 격리 환경을 만들기 때문에 성능 손실이 거의 없다. 컨테이너에 필요한 커널은 host의 커널을 공유해 사용하고, 컨테이너 안에는  
  애플리케이션을 구동하는 데 필요한 라이브러리 및 실행 파일만 존재하기 때문에 컨테이너를 이미지로 만들었을 때 이미지의 크기 또한 VM에 비해  
  대폭 줄어든다. 따라서 컨테이너를 이미지로 만들어 배포하는 시간이 VM에 비해 빠르며 가상화된 공간을 사용할 때의 성능 손실도 거의 없다는  
  장점이 있다.

---

## Why docker?

### 애플리케이션 개발 및 배포의 편리성

- 서버를 booting할 때 실행되는 OS를 일반적으로 Host OS라 하며, docker container는 host OS위에서 실행되는 격리된 공간이다.  
  따라서 컨테이너 자체에 특별한 권한을 주지 않는 한, 컨테이너 내부에서 수많은 소프트웨어를 설치하고 설정 파일을 수정해도 host OS에는 영향을  
  끼치지 않는다. 즉, 완전히 독립된 개발 환경을 보장받을 수 있는 것이다.

- 컨테이너 내부에서 여러 작업을 마친 뒤 이를 배포하려 하면, 해당 컨테이너를 docker image라 하는 일종의 패키지로 만들어 운영 서버에 전달만  
  하면 된다. 컨테이너에서 사용되던 운영 서버에서 새롭게 패키지를 설치할 필요도 없으며, 각종 라이브러리 설치 등으로 인한 의존성에 대한 걱정을  
  할 필요도 없다. 서비스를 개발했을 때 사용하던 환경을 다른 서버에서도 컨테이너로서 똑같이 복제할 수 있기에 개발/운영 환경의 통합이 가능해진다.

- 게다가 docker image는 VM image와는 달리 커널을 포함하고 있지 않아 이미지 크기가 크지 않다. 또한 docker는 이미지를 layer 단위로  
  구성하며, 중복되는 layer를 재사용할 수 있어 애플리케이션의 배포 속도가 매우 빨라진다는 장점이 있다.

### 애플리케이션의 독립성과 확장성 증가

- 소프트웨어의 여러 모듈이 상호 작용하는 로직을 하나의 프로그램 내에서 구동시키는 방식을 monolithic 애플리케이션이라 한다.  
  소규모 서비스에서는 이 방식이 어울릴수도 있지만, 서비스의 기능이 복잡해지고 거대해질수록 소프트웨어 자체의 확장성과 유연성이  
  줄어든다는 단점이 있다. 이러한 monolithic 방식을 대체하기 위해 떠오른 개념이 MSA 구조이다.

  ![picture 118](/images/DK_1_2.png)

- MSA는 여러 모듈을 독립된 형태로 구성하기 때문에 언어에 종속되지 않고 변화에 빠르게 대응할 수 있으며, 각 모듈의 관리가 쉬워진다는 장점이 있다.  
  컨테이너는 수 초 내로 생성, 시작이 가능할 뿐만 아니라 여러 모듈에게 독립된 환경을 동시에 제공할 수 있기 때문에 MSA 구조에서 가장 많이  
  사용되는 가상화 기술이다.

- 부하가 많아지는 서비스만 동적으로 늘려 부하를 분산시킬 수 있어 확장성도 뛰어나고, 각 서비스마다 이미지 버전을 독립적으로 관리하기에 독립성 또한 높다.

---
