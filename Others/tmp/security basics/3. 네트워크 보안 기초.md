# 3 - 네트워크 보안 기초

## OSI 7 Layer

| level |  layer name  |      description       |
| :---: | :----------: | :--------------------: |
|   7   | application  |       L7 스위치        |
|   6   | presentation |           -            |
|   5   |   session    |           -            |
|   4   |  transport   |       L4 스위치        |
|   3   |   network    |         라우터         |
|   2   |  data link   | 랜카드, 브릿지, 스위치 |
|   1   |   physical   |  케이블, 허브, 리피터  |

- Layer 1: Physical layer

  - 실제 장치들을 연결하기 위해 필요한 전기적, 물리적 세부 사항 정의
  - 네트워크 상에서 데이터 비트를 전송하는 계층
  - 회선으로는 전용 회선과 교환 회선이 있다.
  - 데이터 교환 방식:
    - 메시지: 목적지를 담은 header와 본문 text
    - packet: 작은 블록을 packet 단위로 나눠 전달해 짧은 데이터 송수신에 적합하다.

- Layer 2: Data link layer

  - 물리적 링크를 이용해 신뢰성 있는 데이터를 전송하는 계층

- Layer 3: network layer

  - 경로를 찾아준다.

- Layer 4: Transport layer

  - 프로토콜과 관련된 계층으로, 오류 복구, 흐름 제어 등을 담당하며 두 시스템 간에 신뢰성 있는 데이터를 전송한다.

- Layer 5: Session layer

  - Application layer의 통신을 제어하는 구조를 제공하기 위해 application layer 사이의 접속을 설정, 유지, 종료한다.

- Layer 6: Presentation layer

  - 컴퓨터 시스템과 네트워크 사이에서 요구하는 포맷으로 맞춰준다.

- Layer 7: Application layer

  - 사용자, 소프트웨어가 네트워크에 접근하는 기능 제공

## TCP/IP 4 Layer

- Layer 1: network interface layer
- Layer 2: Internet layer
- Layer 3: Transport layer
- Layer 4: Application layer

## IP(Internet Protocol)

- Packet의 destination IP address를 보고, 네트워크의 최적 경로를 찾아준다.
- IP 자체는 connectionless로, 손실, 중복, 지연, 순서 바뀜 등이 가능하다.
- IP 동작 과정은 각 호스트와 라우터 사이에서 작동한다.
- IP의 데이터로는 ICMP, TCP, UDP, IGMP 등이 있다.

## ICMP(Internet Control Message Protocol)

- 기능:

  - 네트워크 상의 에러 보고
  - 네트워크의 혼잡도 보고
  - Troubleshooting
  - 타임아웃 보고

## ARP, RARP

- ARP: 논리적 주소(logical address)를 물리적 주소(physical address)로 변환하는 프로토콜
- RARP: ARP의 반대로, 물리적 주소를 논리적 주소로 변환하는 프로토콜

## TCP, UDP

- TCP:

  - 1:1의 connection-oriented protocol
  - 신뢰할 수 있는 통신 서비스 제공
  - TCP 연결 확립, 패킷 확인, 순서화, 전달 중 손실된 패킷 복구

- UDP
  - 1:1 혹은 1:N 간의 connectionless protocol
  - 신뢰할 수 없는 통신 서비스 제공
  - 전달할 데이터 크기가 작거나, TCP connection 수립의 부하를 피할 때 사용

## Layer 3(network layer)의 보안 프로토콜

### IPSec protocol

- 구성요소:

  - (1) AH(Authentication Header): 데이터의 무결성 검사

    - Header에 packet 내용이 암호화되어 생긴 hash 가 포함된다.
    - Sniffing 후 데이터를 변조하고, 다시 보내는 replay attack 방지가 가능하다.

  - (2) ESP(Encapsulating Security Payload)

    - Payload 암호화 후 packet header에 순차적으로 번호 부여
    - 수신자는 해당 번호를 통해 중복 packet을 걸러낸다.

  - (3) IKE(Internet Key Exchange)
    - 통신 중인 host 간의 security assocation 확립
    - Session에서 사용할 암호 key, 암호화 알고리즘 협상

- IPSec 모드

  - IPSec 터널 모드: 새로운 header를 생성하고, 원본 packet과 함께 전체를 암호화한다.

    - 원본 IP header를 보호하기에, 최초 출발지와 최종 목적지에 대한 트래픽 정보의 기밀성이 유지된다.

  - IPSec 전송 모드: header는 암호화하지 않고, payload만 암호화한다.

    - Header를 보호하지 않기에 트래픽 흐름 분석이 가능하다.

### SSL(Secure Socket Layer)

- IPSec보다 상위 수준에서 암호화 통신 기능 제공
- 보통 4계층(transport), 5계층(session)에서 사용

### SSL VPN vs IPSec VPN

| SSL VPN                                                   | IPSec VPN                             |
| --------------------------------------------------------- | ------------------------------------- |
| OSI 7 layer 중 상위 layer에 제한적 지원                   | OSI 7 layer 중 상위 layer에 비 종속적 |
| 별도의 클라이언트 프로그램 필요 x(브라우저 내장 SSL 사용) | 별도의 클라이언트 프로그램 필요       |
| SEED 알고리즘 지원 X                                      | SEED 알고리즘 지원 O                  |
| 사설 IP 지원 한계                                         | QoS 구현의 한계                       |

## Layer 7(Application layer)의 보안 프로토콜

- `MIME`(Multipurpose Internet Mail Extensions): ASCII data 만을 처리할 수 있는 원래의 email protocol
- `PGP`(Pretty Good Privacy): MIME 객체에 암호화, 전자서명 기능을 추가한 프로토콜

  - 기밀성, 메시지 인증, 사용자 인증, 송신 부인 방지 제공

- `S/MIME`: email의 형식을 확장해 ASCII 이외의 것들(오디오, 비디오, 이미지 등)을 지원하는 email protocol

  - email 통신의 표준이다.

- PGP vs PEM

  - PGP:

    - 공개 알고리즘 사용
    - 다양한 애플리케이션에 적용할 수 있도록 plugin 형태로 제공
    - 공개 key 서버와 직접 연결
    - 분산형
    - 송신자의 전자 서명을 통해 무결성 및 부인 방지를 제공한다.

  - PEM:
    - 공개 알고리즘 사용
    - 중앙 집중형
    - 복잡한 알고리즘을 사용해 보안성이 우수하다.

## DoS/DDoS

- 리소스 고갈형 공격: SYN Flooding
- Bandwidth 잠식형 공격: 스머프 공격, UDP 진단 포트 공격
- Route 조작: ICMP router discovery attack
- OS, 서버 프로그램의 취약점을 이용한 공격: 랜드 공격, Ping of death 공격, 티어드롭 공격
